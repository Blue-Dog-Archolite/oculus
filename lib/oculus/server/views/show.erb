<h1><%= @query.description %></h1>

<dl class="dl-horizontal">
  <dt>Author</dt>
  <dd><%= @query.author %></dd>
  <dt>Timestamp</dt>
  <dd><%= @query.formatted_date %></dd>
</dl>

<pre class="cm-s-default"><%= @query.query %></pre>

<% if @query.ready? %>
  <table id="results-table">
    <thead>
      <tr>
        <% @headers.each do |label| %>
          <th><%= label %></th>
        <% end %>
      </tr>
    </thead>
    <tbody id="results">
      <% @results.each do |result| %>
        <tr>
          <% result.each do |value| %>
            <td><%= value %></td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <div class="alert alert-info">
    <strong>Head's Up!</strong>
    This query is in progress, and has not returned any results yet.
  </div>
<% end %>

<script type="text/javascript">
  var queryNode = $('pre.cm-s-default');
  CodeMirror.runMode(queryNode.text(), 'mysql', queryNode[0]);
</script>
